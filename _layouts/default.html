<!doctype html>

<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		{% seo %}

		<!-- ICONS -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<!-- GOOGLE FONT -->
		<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400&display=swap" rel="stylesheet">
		<link rel="icon" type="image/png" href="{{ site.baseurl }}/favicon.png">
		<link href="https://cdn.snipcart.com/themes/2.0/base/snipcart.min.css" type="text/css" rel="stylesheet">

		{% if jekyll.environment == 'production' and site.google_analytics_key != '' %}
			<script>
				window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
				ga('create', '{{ site.google_analytics_key }}', 'auto');
				ga('send', 'pageview');
			</script>
			<script async src='https://www.google-analytics.com/analytics.js'></script>
		{% endif %}

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
		{% if site.snipcart_key %}
			<script src="https://cdn.snipcart.com/scripts/2.0/snipcart.js" id="snipcart" data-api-key="{{ site.snipcart_key }}"></script>
		{% endif %}

		<!-- MAIN CSS -->
		<link rel="stylesheet" href="{{ site.baseurl }}/css/screen.css">
	</head>
	<body>
		<header class="mainNavigation{% if page.title == 'Stories' %} transparentNav{%endif%}">
			<nav class="container">
				<input type="checkbox" name="" id="check">
				<a id="headerLogo" class="logo-container" href="{{ site.url }}">
					<!-- <h3 class="logo">Brand<span>Name</span></h3> -->
					{% include logo.html %}
				</a>
				{% include navigation.html %}
				<div class="hamburger-menu-container">
					<div class="hamburger-menu">
						<div></div>
					</div>
				</div>
			</nav>
		</header>
		<main class="content grid">
			<!-- Hero -->
			{% include hero.html %}

			<!-- Main content -->
			{{ content }}
		</main>
		<!-- Footer -->
		<footer class="grid">
			{% include footer.html %}
		</footer>

		<!-- TODO -->
		<!-- Convert site to use pagecdn for compression and image conversion https://pagecdn.com/docs/quick-start#setting-up-cdn-on-github-repo -->
		<!-- Make Map script a function that can be called with parameters from each page that uses a map -->
		<!-- Move some of these scripts to application.js -->
		<!-- ADDING GSAP -->
		<script src="{{ site.baseurl }}/js/gsap/gsap.min.js"></script>
		<script src="{{ site.baseurl }}/js/gsap/ScrollTrigger.min.js"></script>
		<script src="{{ site.baseurl }}/js/gsap/ScrollToPlugin.min.js"></script>

		<!-- Litebox script - only used for video player. Replace this with own custom popup -->
		<script src="{{ site.baseurl }}/js/liteboxpro.min.js"></script>

		<!-- Animating the top nav height by changing logo height -->
		<script>
			window.onload = function() {
				var scrollDownIcon = document.getElementById("scrollDown");
				var links = gsap.utils.toArray(".topLevel");
				var isTransparent = document.querySelector(".transparentNav");

				// Animate the scrolldown icon if it exists (At this time it only exists on articles page and scrollytelling page, but scrollytelling page does not use this layout)
				// Also smooth scroll to next section
				if (scrollDownIcon) {
					gsap.to('#scrollDown',{duration:1, yoyo:true, y:-10, repeat:-1},'<');
					scrollDownIcon.addEventListener("click", function(e) {
						e.preventDefault();
						gsap.to(window, {duration: 0.2, scrollTo: "#storiesWrap"});
					});
				}

				function changeColor() {
					links.forEach(link => link.classList.toggle("blackText") )
				}
				var tl = gsap.timeline({
					defaults:{duration:1},
					scrollTrigger: {
						trigger: "body",
						start: 0,
						end: 130,
						onEnter: changeColor,
						onLeaveBack: changeColor,
						toggleActions: "play complete reverse reverse",
						scrub: 1
					}
					});
					tl.to('#headerLogo .logo', {duration:1, height:55, ease:"linear"},'<');
					tl.to('.mainNavigation',{
						duration:1,
						boxShadow: "0 1px 15px rgba(0,0,0, .15)"
					},'<');
					if (isTransparent) {
						tl.to('.mainNavigation',{duration:1,backgroundImage:"linear-gradient(90deg, #89b412 5%, transparent 30%)", backgroundColor:"#abe116"},"<");
					}
					return tl;
			}
		</script>
		<script>
			function animateCards() {
				const cards = document.querySelectorAll('.postPreview');

				cards.forEach(card => {
					// const letters = card.querySelectorAll('a span');
					const author = card.querySelector('.authorImage');
					const overlay = card.querySelector('.overlay');
					const button = card.querySelector('.button');
					const postImage = card.querySelector('.postImage');
					// Timeline
					const tl = gsap.timeline({paused: true});
					tl.to(author, {duration:0.2, scale:1.3}, "<");
					tl.to(button, {duration:0.2, scale:1.2, transformOrigin:"100% 50%"},"<");
					// Hover
					card.addEventListener("mouseenter", function(){
						tl.play();
					});
					card.addEventListener("mouseleave", function(){
						tl.reverse();
					});
				});
			}
			animateCards();
		</script>

		<script>
			feather.replace()
		</script>
		<script>
			new LiteBoxPro({
				theme_color: "white",
				line_width: 1,
				z_index: 2000,
				arrows: {
					default: {
						hide: true
					}
				},
				pager: {
					default: {
						hide: true
					}
				}
			});
		</script>
		<script src="{{ site.baseurl }}/js/application.js" type="text/javascript"></script>
	</body>
</html>